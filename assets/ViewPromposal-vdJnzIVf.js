import{c as p,r as s,j as e,d as A,W as M,H as E,L as v,B as h,s as R,a as T}from"./main-BHPIGV8h.js";import{R as D}from"./index-rTFgChZ3.js";import{A as V}from"./arrow-left-C4HDbgt0.js";import{C as q}from"./check-CszRzhCn.js";import{C as H}from"./copy-EXirslhl.js";import"./index-Chjiymov.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=p("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=p("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=p("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=p("VolumeX",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]),X=({lyrics:t,currentTime:a})=>{const[c,l]=s.useState(null),[o,n]=s.useState(""),i=s.useMemo(()=>{if(!t||t.length===0)return-1;let r=t.length-1;for(;r>=0;){if(t[r].time<=a)return r;r--}return-1},[t,a]);return s.useEffect(()=>{const r=i!==-1?t[i].text:null;if(r!==c){n("animate-fade-out");const u=setTimeout(()=>{l(r),n("animate-fade-in")},500);return()=>clearTimeout(u)}},[i,t,c]),t.length?e.jsx("div",{className:"flex items-center justify-center h-full text-center p-4",children:e.jsx("p",{className:A("text-4xl md:text-6xl font-bold text-foreground drop-shadow-lg",o),children:c||"â™ª"})}):e.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground text-2xl",children:e.jsx("p",{children:"Waiting for the song to start..."})})},K=t=>{if(!t)return[];const a=t.split(`
`),c=[],l=/\[(\d{2}):(\d{2})\.(\d{2,3})\]/;for(const o of a){const n=o.match(l);if(n){const i=parseInt(n[1],10),r=parseInt(n[2],10),u=parseInt(n[3].padEnd(3,"0"),10),m=i*60+r+u/1e3,f=o.replace(l,"").trim();f&&c.push({time:m,text:f})}}return c.sort((o,n)=>o.time-n.time)},O=()=>e.jsxs("div",{className:"min-h-screen bg-background flex flex-col items-center justify-center text-foreground",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"mt-4 text-xl",children:"Loading Your Special Message..."})]}),b=({message:t})=>e.jsxs("div",{className:"min-h-screen bg-background flex flex-col items-center justify-center text-foreground text-center p-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-destructive mb-4",children:"Oops!"}),e.jsx("p",{children:t}),e.jsx(v,{to:"/dashboard",children:e.jsx(h,{variant:"outline",className:"mt-4 text-foreground border-border hover:bg-accent hover:text-accent-foreground",children:"Back to Dashboard"})})]}),$=()=>{const{id:t}=M(),[a,c]=s.useState(null),[l,o]=s.useState(!0),[n,i]=s.useState(null),[r,u]=s.useState(!1),[m,f]=s.useState(!0),[g,w]=s.useState(0),[k,N]=s.useState(0),[L,j]=s.useState(!1),y=s.useRef(null);s.useEffect(()=>{if(!t){i("No promposal ID provided."),o(!1);return}(async()=>{const{data:x,error:I}=await R.from("proposals").select("id, video_url, lrc_content").eq("id",t).single();I||!x?(i("Could not find this promposal. The link may be incorrect or it may have been deleted."),o(!1)):(c(x),o(!1))})()},[t]);const S=s.useMemo(()=>a?K(a.lrc_content):[],[a]),C=d=>{w(d.playedSeconds)},P=d=>{N(d)},z=()=>{navigator.clipboard.writeText(window.location.href),j(!0),T.success("Link copied to clipboard!"),setTimeout(()=>j(!1),2e3)};return l?e.jsx(O,{}):n?e.jsx(b,{message:n}):a?e.jsxs(e.Fragment,{children:[e.jsxs(E,{children:[e.jsx("title",{children:"Promposal - Anbae"}),e.jsx("meta",{name:"description",content:"View a special video promposal with synchronized lyrics created on Anbae."})]}),e.jsxs("div",{className:"fixed inset-0 bg-background z-50 flex flex-col items-center justify-center p-4 md:p-8 text-foreground overflow-hidden",children:[e.jsx("div",{style:{display:"none"},children:e.jsx(D,{ref:y,url:a.video_url,playing:r,muted:m,onProgress:C,onDuration:P,progressInterval:100})}),e.jsx("div",{className:"absolute top-4 left-4 flex items-center gap-2 z-20",children:e.jsx(v,{to:"/dashboard",children:e.jsx(h,{variant:"outline",size:"icon",className:"w-10 h-10 text-foreground border-border hover:bg-accent hover:text-accent-foreground rounded-full shadow-md",children:e.jsx(V,{className:"w-5 h-5"})})})}),e.jsx("div",{className:"absolute top-4 right-4 flex items-center gap-2 z-20",children:e.jsx(h,{onClick:z,variant:"ghost",size:"icon",className:"text-foreground hover:bg-accent hover:text-accent-foreground",children:L?e.jsx(q,{className:"w-5 h-5 text-primary"}):e.jsx(H,{className:"w-5 h-5"})})}),e.jsx("div",{className:"w-full h-full flex flex-col justify-center items-center",children:e.jsx(X,{lyrics:S,currentTime:g})}),e.jsx("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 w-full max-w-xl z-20",children:e.jsxs("div",{className:"flex items-center justify-center gap-4 mt-4 p-2 bg-card/80 rounded-full shadow-lg backdrop-blur-md border border-border/50",children:[e.jsx(h,{onClick:()=>u(!r),variant:"ghost",size:"icon",className:"text-foreground hover:bg-accent hover:text-accent-foreground",children:r?e.jsx(_,{className:"w-6 h-6"}):e.jsx(B,{className:"w-6 h-6"})}),e.jsx("input",{type:"range",min:0,max:k,value:g,onChange:d=>{var x;return(x=y.current)==null?void 0:x.seekTo(parseFloat(d.target.value))},className:"w-full h-1.5 bg-muted rounded-lg appearance-none cursor-pointer range-sm accent-primary"}),e.jsx(h,{onClick:()=>f(!m),variant:"ghost",size:"icon",className:"text-foreground hover:bg-accent hover:text-accent-foreground",children:m?e.jsx(W,{className:"w-6 h-6"}):e.jsx(F,{className:"w-6 h-6"})})]})})]})]}):e.jsx(b,{message:"Something went wrong."})};export{$ as default};
