import{c as E,n as L,b as S,u as z,r as a,w as g,j as e,H as _,T as b,o as w,L as B,B as i,p as y,q as v,s as N,a as m}from"./main-DjNC3G64.js";import{C as A,a as J,b as q,c as F}from"./card-DWGr94Ni.js";import{B as H}from"./BackgroundWrapper-B09iK6D5.js";import{A as G}from"./arrow-left-CCXN5EYU.js";import{T as Y}from"./trash-2-6OB0sbNG.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=E("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]),Q=()=>{var f,j;const{user:o,loading:n}=L(),d=S(),r=z(),[h,D]=a.useState([]),[k,x]=a.useState(!0),[t,l]=a.useState((f=r.state)!=null&&f.selectedDate?new Date(r.state.selectedDate):new Date);a.useEffect(()=>{var s;(s=r.state)!=null&&s.selectedDate?l(new Date(r.state.selectedDate)):l(new Date)},[(j=r.state)==null?void 0:j.selectedDate]);const u=async()=>{if(!o)return;x(!0);const{data:s,error:c}=await N.from("journal_entries").select("*").eq("user_id",o.id).order("created_at",{ascending:!1});c?m.error("Failed to load journal entries."):D(s),x(!1)};a.useEffect(()=>{!n&&o?u():!n&&!o&&d("/login")},[o,n,d]);const M=async s=>{const{error:c}=await N.from("journal_entries").delete().eq("id",s);c?m.error("Failed to delete entry."):(m.success("Entry deleted."),u())},p=a.useMemo(()=>t?h.filter(s=>g(new Date(s.created_at),t)):[],[h,t]),C=a.useMemo(()=>t?g(t,new Date):!0,[t]),T=()=>{l(new Date),d(r.pathname,{replace:!0,state:{}})};return e.jsxs(e.Fragment,{children:[e.jsxs(_,{children:[e.jsx("title",{children:"Journal - Anbae"}),e.jsx("meta",{name:"description",content:"Your personal journal on Anbae. Track your moods, write entries, and reflect on your relationship journey."})]}),e.jsx(H,{className:"pt-0 md:pt-0",children:e.jsxs("div",{className:"w-full max-w-2xl mx-auto p-4 md:p-8 mt-16 md:mt-8",children:[e.jsxs("header",{className:"flex justify-between items-center mb-6",children:[e.jsx("div",{className:"absolute top-3 left-3 z-10",children:e.jsxs(b,{children:[e.jsx(w,{asChild:!0,children:e.jsx(B,{to:"/dashboard",children:e.jsx(i,{variant:"outline",size:"icon",className:"w-9 h-9 sm:w-10 sm:h-10 rounded-full text-foreground border-border hover:bg-accent hover:text-accent-foreground shadow-md",children:e.jsx(G,{className:"w-4 h-4 sm:w-5 sm:h-5"})})})}),e.jsx(y,{children:e.jsx("p",{children:"Back to Dashboard"})})]})}),e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground mx-auto",children:"Journal"}),!C&&e.jsx("div",{className:"absolute top-3 right-3 z-10",children:e.jsxs(b,{children:[e.jsx(w,{asChild:!0,children:e.jsx(i,{variant:"outline",size:"icon",onClick:T,className:"w-9 h-9 sm:w-10 sm:h-10 rounded-full text-foreground border-border hover:bg-accent hover:text-accent-foreground shadow-md",children:e.jsx(I,{className:"w-4 h-4 sm:w-5 sm:h-5"})})}),e.jsx(y,{children:e.jsx("p",{children:"Go to Today"})})]})})]}),e.jsx("div",{className:"flex flex-col gap-6 sm:gap-8",children:e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg sm:text-xl font-bold mb-3 sm:mb-4 text-foreground",children:["Entries for ",t?v(t,"MMMM d, yyyy"):"today"]}),e.jsx("div",{className:"space-y-3 sm:space-y-4 max-h-[60vh] overflow-y-auto pr-2",children:k?e.jsx("p",{className:"text-muted-foreground text-sm sm:text-base",children:"Loading entries..."}):p.length>0?p.map(s=>e.jsxs(A,{className:"bg-card/50 dark:bg-card/50 border border-border/50 shadow-md rounded-xl p-3 sm:p-4",children:[e.jsxs(J,{className:"flex flex-row justify-between items-start pb-1 sm:pb-2",children:[e.jsxs("div",{children:[e.jsxs(q,{className:"text-base sm:text-lg text-foreground",children:[s.emoji," ",s.heading]}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:v(new Date(s.created_at),"p")})]}),e.jsx(i,{variant:"ghost",size:"icon",onClick:()=>M(s.id),className:"w-8 h-8 text-destructive hover:bg-destructive/20",children:e.jsx(Y,{className:"w-4 h-4"})})]}),e.jsx(F,{className:"pt-0 text-sm sm:text-base",children:e.jsx("p",{className:"whitespace-pre-wrap text-foreground",children:s.content})})]},s.id)):e.jsx("p",{className:"text-muted-foreground text-sm sm:text-base",children:"No entries for this day. You can add one from the Dashboard!"})})]})})]})})]})};export{Q as default};
