import{c as T,b as L,a8 as P,r as d,j as e,H as J,T as S,o as B,L as M,B as g,p as U,s as f}from"./main-DjNC3G64.js";import{I as $}from"./input-jGJX85w3.js";import{C as w,a as C,b as y,d as N,c as v}from"./card-DWGr94Ni.js";import{B as q}from"./BackgroundWrapper-B09iK6D5.js";import{A}from"./arrow-left-CCXN5EYU.js";import{U as D}from"./users-DyCn6oqI.js";import{L as I}from"./log-in-Cf6AHWQQ.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=T("Waves",[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]]),W=()=>{const t="ABCDEFGHIJKLMNPQRSTUVWXYZ123456789";let s="";for(let n=0;n<4;n++)s+=t.charAt(Math.floor(Math.random()*t.length));return s},V=()=>{const t=L(),{roomCode:s,isConnectedToRoom:n}=P(),[x,E]=d.useState(""),[u,o]=d.useState(null),[b,l]=d.useState(null),[j,h]=d.useState(null);d.useEffect(()=>{s&&n&&t(`/concert/${s}`)},[s,n,t]);const R=async()=>{o("create"),l(null),h(null);let r="",a=!1,c=0;for(;!a&&c<10;){r=W();const{error:m}=await f.from("wave_rooms").select("code").eq("code",r).single();if(m&&m.code==="PGRST116")a=!0;else if(m){console.error("Error checking for room code uniqueness:",m),l(`Could not verify room code: ${m.message}. Please try again.`),o(null);return}c++}if(!a){l("Failed to generate a unique room code after multiple attempts. Please try again."),o(null);return}const{data:i,error:p}=await f.from("wave_rooms").insert({code:r,is_playing:!1}).select().single();p?(console.error("Error creating room:",p),l(`Could not create a room: ${p.message}. Please try again.`)):i&&t(`/concert/${i.code}`),o(null)},k=async r=>{if(r.preventDefault(),!x.trim()){h("Please enter a room code.");return}o("join"),h(null),l(null);const a=x.trim().toUpperCase(),{data:c,error:i}=await f.from("wave_rooms").select("code").eq("code",a).single();i||!c?(console.error("Error finding room:",i),h(`Room with code "${a}" not found.`)):t(`/concert/${c.code}`),o(null)};return e.jsxs(e.Fragment,{children:[e.jsxs(J,{children:[e.jsx("title",{children:"Concert - Anbae"}),e.jsx("meta",{name:"description",content:"Create or join a Concert to listen to internet radio stations with your partner in real-time."})]}),e.jsxs(q,{className:"pt-0 md:pt-0",children:[e.jsxs("div",{className:"relative w-full max-w-xl sm:max-w-4xl mx-auto mt-16 md:mt-8 mb-8 sm:mb-12 px-4",children:[" ",e.jsxs("div",{className:"absolute top-1/2 -translate-y-1/2 left-3 z-10",children:[" ",e.jsxs(S,{children:[e.jsx(B,{asChild:!0,children:e.jsx(M,{to:"/dashboard",children:e.jsx(g,{variant:"outline",size:"icon",className:"w-9 h-9 sm:w-10 sm:h-10 rounded-full text-foreground border-border hover:bg-accent hover:text-accent-foreground shadow-md",children:e.jsx(A,{className:"w-4 h-4 sm:w-5 sm:h-5"})})})}),e.jsx(U,{children:e.jsx("p",{children:"Back to Dashboard"})})]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(H,{className:"w-16 h-16 sm:w-20 h-20 text-primary mx-auto mb-3 sm:mb-4"})," ",e.jsx("h1",{className:"text-4xl sm:text-5xl font-bold tracking-tighter mb-1 sm:mb-2 text-foreground",children:"Concert"})," ",e.jsx("p",{className:"text-base sm:text-lg text-muted-foreground max-w-xl mx-auto",children:"Listen to internet radio with friends, in real-time."})," "]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 sm:gap-8 w-full max-w-xl sm:max-w-4xl px-4",children:[" ",e.jsxs(w,{className:"bg-card/60 backdrop-blur-md border border-border/50 text-foreground flex flex-col rounded-xl shadow-lg transition-all duration-300 hover:shadow-xl hover:scale-[1.02] p-6 sm:p-8",children:[" ",e.jsxs(C,{className:"text-center pb-4",children:[" ",e.jsx(D,{className:"w-10 h-10 sm:w-12 h-12 text-primary mx-auto mb-3 sm:mb-4"})," ",e.jsx(y,{className:"text-xl sm:text-2xl",children:"Create a New Room"})," ",e.jsx(N,{className:"text-muted-foreground text-sm sm:text-base",children:"Start a new listening party and invite others to join."})]}),e.jsxs(v,{className:"flex flex-col flex-grow justify-end pt-0",children:[b&&e.jsx("p",{className:"text-destructive text-xs sm:text-sm mb-2",children:b})," ",e.jsx(g,{onClick:R,disabled:!!u,className:"w-full bg-primary hover:bg-primary/90 text-primary-foreground text-sm sm:text-base py-2.5 sm:py-3",children:u==="create"?"Creating...":"Create Room"})]})]}),e.jsxs(w,{className:"bg-card/60 backdrop-blur-md border border-border/50 text-foreground flex flex-col rounded-xl shadow-lg transition-all duration-300 hover:shadow-xl hover:scale-[1.02] p-6 sm:p-8",children:[" ",e.jsxs(C,{className:"text-center pb-4",children:[" ",e.jsx(I,{className:"w-10 h-10 sm:w-12 h-12 text-secondary mx-auto mb-3 sm:mb-4"})," ",e.jsx(y,{className:"text-xl sm:text-2xl",children:"Join an Existing Room"})," ",e.jsx(N,{className:"text-muted-foreground text-sm sm:text-base",children:"Enter a room code below to join your friends."})]}),e.jsx(v,{className:"pt-0",children:e.jsxs("form",{onSubmit:k,className:"flex flex-col gap-3 sm:gap-4",children:[" ",e.jsx($,{type:"text",value:x,onChange:r=>E(r.target.value.toUpperCase()),placeholder:"ENTER CODE",className:"text-center font-mono tracking-widest text-lg sm:text-xl bg-input/50 border-border/50 text-foreground focus:ring-primary h-10 sm:h-12",maxLength:4}),j&&e.jsx("p",{className:"text-destructive text-xs sm:text-sm mt-2",children:j})," ",e.jsx(g,{type:"submit",disabled:!x.trim()||!!u,className:"bg-secondary hover:bg-secondary/90 text-secondary-foreground text-sm sm:text-base py-2.5 sm:py-3",children:u==="join"?"Joining...":"Join Room"})]})})]})]})]})]})};export{V as default};
