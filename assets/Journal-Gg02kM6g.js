import{c as E,l as L,b as S,u as z,r as a,p as g,j as e,H as _,T as y,m as b,L as B,B as c,n as w,o as v,s as N,a as h}from"./main-BHPIGV8h.js";import{C as A,a as J,b as F,c as H}from"./card-CN1N3ooC.js";import{B as q}from"./BackgroundWrapper-C6a75pID.js";import{A as G}from"./arrow-left-C4HDbgt0.js";import{T as Y}from"./trash-2-BzPjE_U0.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=E("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]),Q=()=>{var p,j;const{user:o,loading:n}=L(),d=S(),r=z(),[u,D]=a.useState([]),[k,m]=a.useState(!0),[s,l]=a.useState((p=r.state)!=null&&p.selectedDate?new Date(r.state.selectedDate):new Date);a.useEffect(()=>{var t;(t=r.state)!=null&&t.selectedDate?l(new Date(r.state.selectedDate)):l(new Date)},[(j=r.state)==null?void 0:j.selectedDate]);const x=async()=>{if(!o)return;m(!0);const{data:t,error:i}=await N.from("journal_entries").select("*").eq("user_id",o.id).order("created_at",{ascending:!1});i?h.error("Failed to load journal entries."):D(t),m(!1)};a.useEffect(()=>{!n&&o?x():!n&&!o&&d("/login")},[o,n,d]);const M=async t=>{const{error:i}=await N.from("journal_entries").delete().eq("id",t);i?h.error("Failed to delete entry."):(h.success("Entry deleted."),x())},f=a.useMemo(()=>s?u.filter(t=>g(new Date(t.created_at),s)):[],[u,s]),C=a.useMemo(()=>s?g(s,new Date):!0,[s]),T=()=>{l(new Date),d(r.pathname,{replace:!0,state:{}})};return e.jsxs(e.Fragment,{children:[e.jsxs(_,{children:[e.jsx("title",{children:"Journal - Anbae"}),e.jsx("meta",{name:"description",content:"Your personal journal on Anbae. Track your moods, write entries, and reflect on your relationship journey."})]}),e.jsx(q,{className:"pt-0 md:pt-0",children:e.jsxs("div",{className:"w-full max-w-2xl mx-auto p-4 md:p-8 mt-16 md:mt-8",children:[e.jsxs("header",{className:"flex justify-between items-center mb-6",children:[e.jsx("div",{className:"absolute top-4 left-4 z-10",children:e.jsxs(y,{children:[e.jsx(b,{asChild:!0,children:e.jsx(B,{to:"/dashboard",children:e.jsx(c,{variant:"outline",size:"icon",className:"w-10 h-10 rounded-full text-foreground border-border hover:bg-accent hover:text-accent-foreground shadow-md",children:e.jsx(G,{className:"w-5 h-5"})})})}),e.jsx(w,{children:e.jsx("p",{children:"Back to Dashboard"})})]})}),e.jsx("h1",{className:"text-3xl font-bold text-foreground mx-auto",children:"Journal"}),!C&&e.jsx("div",{className:"absolute top-4 right-4 z-10",children:e.jsxs(y,{children:[e.jsx(b,{asChild:!0,children:e.jsx(c,{variant:"outline",size:"icon",onClick:T,className:"w-10 h-10 rounded-full text-foreground border-border hover:bg-accent hover:text-accent-foreground shadow-md",children:e.jsx(I,{className:"w-5 h-5"})})}),e.jsx(w,{children:e.jsx("p",{children:"Go to Today"})})]})})]}),e.jsx("div",{className:"flex flex-col gap-8",children:e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold mb-4 text-foreground",children:["Entries for ",s?v(s,"MMMM d, yyyy"):"today"]}),e.jsx("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto pr-2",children:k?e.jsx("p",{className:"text-muted-foreground",children:"Loading entries..."}):f.length>0?f.map(t=>e.jsxs(A,{className:"bg-card/50 dark:bg-card/50 border border-border/50 shadow-md rounded-xl",children:[e.jsxs(J,{className:"flex flex-row justify-between items-start pb-2",children:[e.jsxs("div",{children:[e.jsxs(F,{className:"text-lg text-foreground",children:[t.emoji," ",t.heading]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:v(new Date(t.created_at),"p")})]}),e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>M(t.id),className:"text-destructive hover:bg-destructive/20",children:e.jsx(Y,{className:"w-4 h-4"})})]}),e.jsx(H,{className:"pt-0",children:e.jsx("p",{className:"whitespace-pre-wrap text-foreground",children:t.content})})]},t.id)):e.jsx("p",{className:"text-muted-foreground",children:"No entries for this day. You can add one from the Dashboard!"})})]})})]})})]})};export{Q as default};
