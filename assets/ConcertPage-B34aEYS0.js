import{c as L,j as e,b as T,a5 as P,r as d,H as J,T as S,n as B,L as I,B as p,o as M,s as f}from"./main-CivNnYL8.js";import{I as U}from"./input-D0mAX1KL.js";import{C as w,a as v,b as C,d as y,c as N}from"./card-D-a4mdTg.js";import{B as $}from"./BackgroundWrapper-iiVBtvC3.js";import{A as q}from"./arrow-left-CxyQXc3_.js";import{U as A}from"./users-CvXF24er.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=L("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),V=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 6.75h7.5M8.25 12h7.5m-7.5 5.25h7.5m-11.25-9a1.5 1.5 0 0 1-3 0V7.5a1.5 1.5 0 0 1 3 0v1.5Zm0 6.75a1.5 1.5 0 0 1-3 0V15a1.5 1.5 0 0 1 3 0v.75Zm9.75-6.75a1.5 1.5 0 0 1-3 0V7.5a1.5 1.5 0 0 1 3 0v1.5Zm0 6.75a1.5 1.5 0 0 1-3 0V15a1.5 1.5 0 0 1 3 0v.75Z"})}),Z=()=>{const t="ABCDEFGHIJKLMNPQRSTUVWXYZ123456789";let o="";for(let n=0;n<4;n++)o+=t.charAt(Math.floor(Math.random()*t.length));return o},K=()=>{const t=T(),{roomCode:o,isConnectedToRoom:n}=P(),[x,E]=d.useState(""),[u,s]=d.useState(null),[b,l]=d.useState(null),[j,h]=d.useState(null);d.useEffect(()=>{o&&n&&t(`/concert/${o}`)},[o,n,t]);const k=async()=>{s("create"),l(null),h(null);let r="",a=!1,i=0;for(;!a&&i<10;){r=Z();const{error:m}=await f.from("wave_rooms").select("code").eq("code",r).single();if(m&&m.code==="PGRST116")a=!0;else if(m){console.error("Error checking for room code uniqueness:",m),l(`Could not verify room code: ${m.message}. Please try again.`),s(null);return}i++}if(!a){l("Failed to generate a unique room code after multiple attempts. Please try again."),s(null);return}const{data:c,error:g}=await f.from("wave_rooms").insert({code:r,is_playing:!1}).select().single();g?(console.error("Error creating room:",g),l(`Could not create a room: ${g.message}. Please try again.`)):c&&t(`/concert/${c.code}`),s(null)},R=async r=>{if(r.preventDefault(),!x.trim()){h("Please enter a room code.");return}s("join"),h(null),l(null);const a=x.trim().toUpperCase(),{data:i,error:c}=await f.from("wave_rooms").select("code").eq("code",a).single();c||!i?(console.error("Error finding room:",c),h(`Room with code "${a}" not found.`)):t(`/concert/${i.code}`),s(null)};return e.jsxs(e.Fragment,{children:[e.jsxs(J,{children:[e.jsx("title",{children:"Concert - Anbae"}),e.jsx("meta",{name:"description",content:"Create or join a Concert to listen to internet radio stations with your partner in real-time."})]}),e.jsxs($,{className:"pt-0 md:pt-0",children:[e.jsxs("div",{className:"relative w-full max-w-xl sm:max-w-4xl mx-auto mt-16 md:mt-8 mb-8 sm:mb-12 px-4",children:[" ",e.jsxs("div",{className:"absolute top-1/2 -translate-y-1/2 left-3 z-10",children:[" ",e.jsxs(S,{children:[e.jsx(B,{asChild:!0,children:e.jsx(I,{to:"/dashboard",children:e.jsx(p,{variant:"outline",size:"icon",className:"w-9 h-9 sm:w-10 sm:h-10 rounded-full text-foreground border-border hover:bg-accent hover:text-accent-foreground shadow-md",children:e.jsx(q,{className:"w-4 h-4 sm:w-5 sm:h-5"})})})}),e.jsx(M,{children:e.jsx("p",{children:"Back to Dashboard"})})]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(V,{className:"w-16 h-16 sm:w-20 h-20 text-primary mx-auto mb-3 sm:mb-4"})," ",e.jsx("h1",{className:"text-4xl sm:text-5xl font-bold tracking-tighter mb-1 sm:mb-2 text-foreground",children:"Concert"})," ",e.jsx("p",{className:"text-base sm:text-lg text-muted-foreground max-w-xl mx-auto",children:"Listen to internet radio with friends, in real-time."})," "]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 sm:gap-8 w-full max-w-xl sm:max-w-4xl px-4",children:[" ",e.jsxs(w,{className:"bg-card/60 backdrop-blur-md border border-border/50 text-foreground flex flex-col rounded-xl shadow-lg transition-all duration-300 hover:shadow-xl hover:scale-[1.02] p-6 sm:p-8",children:[" ",e.jsxs(v,{className:"text-center pb-4",children:[" ",e.jsx(A,{className:"w-10 h-10 sm:w-12 h-12 text-primary mx-auto mb-3 sm:mb-4"})," ",e.jsx(C,{className:"text-xl sm:text-2xl",children:"Create a New Room"})," ",e.jsx(y,{className:"text-muted-foreground text-sm sm:text-base",children:"Start a new listening party and invite others to join."})]}),e.jsxs(N,{className:"flex flex-col flex-grow justify-end pt-0",children:[b&&e.jsx("p",{className:"text-destructive text-xs sm:text-sm mb-2",children:b})," ",e.jsx(p,{onClick:k,disabled:!!u,className:"w-full bg-primary hover:bg-primary/90 text-primary-foreground text-sm sm:text-base py-2.5 sm:py-3",children:u==="create"?"Creating...":"Create Room"})]})]}),e.jsxs(w,{className:"bg-card/60 backdrop-blur-md border border-border/50 text-foreground flex flex-col rounded-xl shadow-lg transition-all duration-300 hover:shadow-xl hover:scale-[1.02] p-6 sm:p-8",children:[" ",e.jsxs(v,{className:"text-center pb-4",children:[" ",e.jsx(D,{className:"w-10 h-10 sm:w-12 h-12 text-secondary mx-auto mb-3 sm:mb-4"})," ",e.jsx(C,{className:"text-xl sm:text-2xl",children:"Join an Existing Room"})," ",e.jsx(y,{className:"text-muted-foreground text-sm sm:text-base",children:"Enter a room code below to join your friends."})]}),e.jsx(N,{className:"pt-0",children:e.jsxs("form",{onSubmit:R,className:"flex flex-col gap-3 sm:gap-4",children:[" ",e.jsx(U,{type:"text",value:x,onChange:r=>E(r.target.value.toUpperCase()),placeholder:"ENTER CODE",className:"text-center font-mono tracking-widest text-lg sm:text-xl bg-input/50 border-border/50 text-foreground focus:ring-primary h-10 sm:h-12",maxLength:4}),j&&e.jsx("p",{className:"text-destructive text-xs sm:text-sm mt-2",children:j})," ",e.jsx(p,{type:"submit",disabled:!x.trim()||!!u,className:"bg-secondary hover:bg-secondary/90 text-secondary-foreground text-sm sm:text-base py-2.5 sm:py-3",children:u==="join"?"Joining...":"Join Room"})]})})]})]})]})]})};export{K as default};
