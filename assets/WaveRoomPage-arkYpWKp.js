import{c as L,j as e,b as T,a1 as P,r as m,H as W,T as J,m as S,L as B,B as f,n as I,s as p}from"./main-BHPIGV8h.js";import{I as M}from"./input-Ds3Oh0yx.js";import{C as b,a as w,b as y,d as C,c as N}from"./card-CN1N3ooC.js";import{B as U}from"./BackgroundWrapper-C6a75pID.js";import{A as $}from"./arrow-left-C4HDbgt0.js";import{U as q}from"./users-D5Y8rFmf.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=L("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),D=r=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...r,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 6.75h7.5M8.25 12h7.5m-7.5 5.25h7.5m-11.25-9a1.5 1.5 0 0 1-3 0V7.5a1.5 1.5 0 0 1 3 0v1.5Zm0 6.75a1.5 1.5 0 0 1-3 0V15a1.5 1.5 0 0 1 3 0v.75Zm9.75-6.75a1.5 1.5 0 0 1-3 0V7.5a1.5 1.5 0 0 1 3 0v1.5Zm0 6.75a1.5 1.5 0 0 1-3 0V15a1.5 1.5 0 0 1 3 0v.75Z"})}),V=()=>{const r="ABCDEFGHIJKLMNPQRSTUVWXYZ123456789";let t="";for(let n=0;n<4;n++)t+=r.charAt(Math.floor(Math.random()*r.length));return t},K=()=>{const r=T(),{roomCode:t,isConnectedToRoom:n}=P(),[x,R]=m.useState(""),[u,a]=m.useState(null),[j,l]=m.useState(null),[v,h]=m.useState(null);m.useEffect(()=>{t&&n&&r(`/waveroom/${t}`)},[t,n,r]);const E=async()=>{a("create"),l(null),h(null);let o="",s=!1,i=0;for(;!s&&i<10;){o=V();const{error:c}=await p.from("wave_rooms").select("code").eq("code",o).single();if(c&&c.code==="PGRST116")s=!0;else if(c){console.error("Error checking for room code uniqueness:",c),l(`Could not verify room code: ${c.message}. Please try again.`),a(null);return}i++}if(!s){l("Failed to generate a unique room code after multiple attempts. Please try again."),a(null);return}const{data:d,error:g}=await p.from("wave_rooms").insert({code:o,is_playing:!1}).select().single();g?(console.error("Error creating room:",g),l(`Could not create a room: ${g.message}. Please try again.`)):d&&r(`/waveroom/${d.code}`),a(null)},k=async o=>{if(o.preventDefault(),!x.trim()){h("Please enter a room code.");return}a("join"),h(null),l(null);const s=x.trim().toUpperCase(),{data:i,error:d}=await p.from("wave_rooms").select("code").eq("code",s).single();d||!i?(console.error("Error finding room:",d),h(`Room with code "${s}" not found.`)):r(`/waveroom/${i.code}`),a(null)};return e.jsxs(e.Fragment,{children:[e.jsxs(W,{children:[e.jsx("title",{children:"Wave Room - Anbae"}),e.jsx("meta",{name:"description",content:"Create or join a Wave Room to listen to internet radio stations with your partner in real-time."})]}),e.jsxs(U,{className:"pt-0 md:pt-0",children:[e.jsxs("div",{className:"relative w-full max-w-4xl mx-auto mt-16 md:mt-8 mb-12",children:[e.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 left-0 z-10",children:e.jsxs(J,{children:[e.jsx(S,{asChild:!0,children:e.jsx(B,{to:"/dashboard",children:e.jsx(f,{variant:"outline",size:"icon",className:"w-10 h-10 rounded-full text-foreground border-border hover:bg-accent hover:text-accent-foreground shadow-md",children:e.jsx($,{className:"w-5 h-5"})})})}),e.jsx(I,{children:e.jsx("p",{children:"Back to Dashboard"})})]})}),e.jsxs("div",{className:"text-center",children:[e.jsx(D,{className:"w-20 h-20 text-primary mx-auto mb-4"})," ",e.jsx("h1",{className:"text-5xl font-bold tracking-tighter mb-2 text-foreground",children:"Wave Room"}),e.jsx("p",{className:"text-muted-foreground text-lg max-w-xl mx-auto",children:"Listen to internet radio with friends, in real-time."})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8 w-full max-w-4xl",children:[e.jsxs(b,{className:"bg-card/60 backdrop-blur-md border border-border/50 text-foreground flex flex-col rounded-xl shadow-lg transition-all duration-300 hover:shadow-xl hover:scale-[1.02]",children:[e.jsxs(w,{className:"text-center",children:[e.jsx(q,{className:"w-12 h-12 text-primary mx-auto mb-4"}),e.jsx(y,{children:"Create a New Room"}),e.jsx(C,{className:"text-muted-foreground",children:"Start a new listening party and invite others to join."})]}),e.jsxs(N,{className:"flex flex-col flex-grow justify-end",children:[j&&e.jsx("p",{className:"text-destructive text-sm mb-2",children:j}),e.jsx(f,{onClick:E,disabled:!!u,className:"w-full bg-primary hover:bg-primary/90 text-primary-foreground",children:u==="create"?"Creating...":"Create Room"})]})]}),e.jsxs(b,{className:"bg-card/60 backdrop-blur-md border border-border/50 text-foreground flex flex-col rounded-xl shadow-lg transition-all duration-300 hover:shadow-xl hover:scale-[1.02]",children:[e.jsxs(w,{className:"text-center",children:[e.jsx(A,{className:"w-12 h-12 text-secondary mx-auto mb-4"}),e.jsx(y,{children:"Join an Existing Room"}),e.jsx(C,{className:"text-muted-foreground",children:"Enter a room code below to join your friends."})]}),e.jsx(N,{children:e.jsxs("form",{onSubmit:k,className:"flex flex-col gap-4",children:[e.jsx(M,{type:"text",value:x,onChange:o=>R(o.target.value.toUpperCase()),placeholder:"ENTER CODE",className:"text-center font-mono tracking-widest text-lg bg-input/50 border-border/50 text-foreground focus:ring-primary",maxLength:4}),v&&e.jsx("p",{className:"text-destructive text-sm mt-2",children:v}),e.jsx(f,{type:"submit",disabled:!x.trim()||!!u,className:"bg-secondary hover:bg-secondary/90 text-secondary-foreground",children:u==="join"?"Joining...":"Join Room"})]})})]})]})]})]})};export{K as default};
